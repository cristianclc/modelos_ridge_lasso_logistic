Traceback (most recent call last):
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\jupyter_core\utils\__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\USER\miniconda3\envs\ml_venv\lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from sklearn.preprocessing import OneHotEncoder

def plot_enhanced_heatmap(data, numeric_vars=[], binary_vars=[], categorical_vars=[], figsize=(30, 30)):
    """
    Heatmap con l√≠neas visibles y mejor legibilidad:
    - L√≠neas de divisi√≥n claras
    - Ajuste autom√°tico de tama√±o de elementos
    - Manejo integrado de todos los tipos de variables
    """
    df = data.copy()
    
    # 1. Procesamiento de variables categ√≥ricas
    if categorical_vars:
        # Filtrar categor√≠as con muchos niveles (mejora legibilidad)
        categorical_vars = [cat for cat in categorical_vars if df[cat].nunique() < 10]
        
        encoder = OneHotEncoder(drop='first', sparse_output=False)
        encoded_cats = encoder.fit_transform(df[categorical_vars])
        encoded_cols = encoder.get_feature_names_out(categorical_vars)
        encoded_df = pd.DataFrame(encoded_cats, columns=encoded_cols, index=df.index)
        df = pd.concat([df.drop(columns=categorical_vars), encoded_df], axis=1)
    
    # 2. Selecci√≥n de variables
    all_vars = numeric_vars + binary_vars + (list(encoded_cols) if categorical_vars else [])
    corr_matrix = df[all_vars].corr()
    
    # 3. Configuraci√≥n visual mejorada
    plt.figure(figsize=figsize)
    
    # Ajuste din√°mico de par√°metros seg√∫n n√∫mero de variables
    n_vars = len(all_vars)
    line_width = 0.5 if n_vars < 30 else 0.3
    font_size = max(6, 12 - int(n_vars/15))
    
    # Heatmap con l√≠neas visibles
    sns.heatmap(
        corr_matrix,
        annot=True,
        fmt=".1f",          # Solo un decimal para mayor claridad
        cmap="coolwarm",
        vmin=-1,
        vmax=1,
        linewidths=line_width,  # Grosor de las l√≠neas
        linecolor='white',      # Color de las l√≠neas (mejor contraste)
        square=True,            # Forma cuadrada para las celdas
        cbar_kws={"shrink": 0.75, "aspect": 10},  # Barra de color m√°s compacta
        annot_kws={"size": font_size}
    )
    
    # Ajustes de t√≠tulo y etiquetas
    plt.title("Matriz de Correlaci√≥n", pad=20, fontsize=16)
    plt.xticks(rotation=45, ha='right', fontsize=font_size)
    plt.yticks(rotation=0, fontsize=font_size)
    
    # Ajustar m√°rgenes para evitar corte de etiquetas
    plt.tight_layout()
    plt.show()

plot_clear_heatmap(df,numericas,binarias,categoricas)
------------------


[1;31m---------------------------------------------------------------------------[0m
[1;31mNameError[0m                                 Traceback (most recent call last)
Cell [1;32mIn[18], line 59[0m
[0;32m     56[0m     plt[38;5;241m.[39mtight_layout()
[0;32m     57[0m     plt[38;5;241m.[39mshow()
[1;32m---> 59[0m [43mplot_clear_heatmap[49m(df,numericas,binarias,categoricas)

[1;31mNameError[0m: name 'plot_clear_heatmap' is not defined

